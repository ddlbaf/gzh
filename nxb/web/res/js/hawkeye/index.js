define("hawkeye/index",["libs/subscribe","libs/template"],function(e,t,s){var a=e("libs/subscribe"),n=e("libs/template");n.helper("numToPercent",function(e){return(100*e).toFixed(2)}),n.helper("shortDate",function(e){return e.substring(4,6)+"."+e.substring(6)});var r={bindEvent:function(){$("body").delegate(".js-tap",$.Func.TAP,function(e){var t=$(this).data("handler");r[t]&&r[t].call(this)})},getFundid:function(e){var t={jsonrpc:"2.0",method:"EagleEyes.EagleEyesInfo",id:54321};$.Func.ajax(t,function(t){t.result&&e&&e(t.result.productclass)})},closeLayer:function(){$(this).parent().parent().removeClass("show")},getEye:function(){var e=this,t={jsonrpc:"2.0",method:"EagleEyes.Broadcast",id:54321,params:{}};$.Func.ajax(t,function(t){var s=t.result,a=s.day.toString();s.newDate=a.substring(0,4)+"年"+a.substring(4,6)+"月"+a.substring(6)+"日";var r=n("broadcast-template",s);$("#broadcast").html(r),e.getHistory(a)})},getHistory:function(e){var t={jsonrpc:"2.0",method:"EagleEyes.BroadcastHistory",id:54321,params:{date:e}};$.Func.ajax(t,function(e){var t=e.result,s=n("probability-template",t);$("#probability").html(s)})},getBlock:function(){var e={jsonrpc:"2.0",method:"EagleEyes.Block",id:54321,params:{}};$.Func.ajax(e,function(e){var t=e.result;if(t&&t.bkdata){t.colors=["bg-blue","bg-pink","bg-yellow","bg-blue","bg-pink","bg-yellow"];var s=n("block-template",t);$("#block").html(s)}else{var s='<li class="empty-li">暂无</li>';$("#block").html(s)}})},init:function(){var e=this;$.Func.getUserInfo(),$.User.wxgzh?e.getFundid(function(t){var s=$.User.userid;a.vipService(s,function(s){~$.inArray(t,s)?(e.getEye(),e.getBlock(),$("#subscribe").removeClass("hide")):($("#noSubscribe").removeClass("hide"),$("#nosubscribeBtn").html('<a class="btn" href="../../pay/pay.html?productid='+t+'"><img src="../res/img/hawkeye/yybb_btn.png" width="100%" alt=""/></a>'))})}):$("#noSubscribe").removeClass("hide"),this.bindEvent()}};s.exports=r});