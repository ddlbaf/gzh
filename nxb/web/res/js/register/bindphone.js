define("register/bindphone",[],function(e,a,n){var s={bindEvent:function(){$("body").delegate(".js-tap","click",function(e){var a=$(this).data("handler");s[a]&&s[a].call(this)})},checkPhone:function(){var e=$("#phone").val();e=e.replace(/(^\s+)|(\s+$)/g,"");var a=/^(((13[0-9]{1})|(15[0-9]{1})|(17[0-9]{1})|(18[0-9]{1}))+\d{8})$/;return!!a.test(e)&&e},checkSmsCode:function(e,a){var n=$("#smsCode").val();n&&(n=n.replace(/(^\s+)|(\s+$)/g,""));var s=new RegExp("^\\d{4}$");if(!n||!s.test(n))return $.Func.pop("请输入正确短信验证码！"),!1;var t={jsonrpc:"2.0",method:"Other.VerifyVerificationCode",id:54321,params:{phone:e,code:n}};$.Func.ajax(t,function(e){var n=e.result;n&&(n.status>1?$.Func.pop(n.statusmsg):$.isFunction(a)&&a())})},getSmsCode:function(){var e=this,a=s.checkPhone();if(!a)return $.Func.pop("请输入有效的手机号码！"),!1;var n={jsonrpc:"2.0",method:"Other.SendVerificationCode",id:54321,params:{phone:a}},t=$(e).attr("disabled");t||$.Func.ajax(n,function(a){var n=a.result;if(n){var s=($(e).attr("disabled"),60);$(e).addClass("disabled").attr("disabled","disabled").html(s+"s后重新获取");var t=setInterval(function(){s--,s>0?$(e).html(s+"s后重新获取"):($(e).removeClass("disabled").removeAttr("disabled").html("重新发送"),clearInterval(t))},1e3)}else $.Func.pop(a.error.message)})},back:function(){history.go(-1)},closeLayer:function(){$("#layer").removeClass("show")},submit:function(){var e,a=s.checkPhone(),n=$.Func.cookie.getCookie("gupiaoxianji_location");switch(n){case"wallet":e=$.CONFIG.CLUB;break;case"fund":e=$.CONFIG.INDEX}s.checkSmsCode(a,function(n){$.User.wxapp||$.Func.bindWeixin(a,$.User.unionid,function(){}),$.User.wxgzh?e?location.href=e:$("body").addClass("show-result"):$.Func.bindGZH(a,$.User.openid,function(a){var n=a.result;if(n)switch(n.status){case 1:$("body").addClass("show-result"),e&&setTimeout(function(){location.href=e},2e3);break;case 2:e?location.href=e:$("body").addClass("show-result");break;default:$.Func.pop(n.statusmsg)}else $.Func.pop(a.error.message)})})},init:function(){$.Func.getUserInfo(),s.bindEvent();var e=$.Func.cookie.getCookie("gupiaoxianji_location");e||$("#back").addClass("hide")}};n.exports=s});