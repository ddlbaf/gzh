define("fund/detail",["libs/pie","libs/template"],function(e,t,n){var i=e("libs/pie"),a=e("libs/template");a.helper("numToPercent",function(e){return(100*e).toFixed(2)+"%"}),a.helper("dateFormate",function(e){var t=e.substring(0,10).split("-");return t[0]+"年"+t[1]+"月"+t[2]+"日"}),a.helper("getNowDate",function(){var e=new Date,t="yyyy-MM-dd h:m:s",n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),"S+":e.getMilliseconds()};/(y+)/i.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in n)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return t});var r={bindEvent:function(){$("body").delegate(".js-tap",$.Func.TAP,function(e){var t=$(this).data("handler");r[t]&&r[t].call(this)})},holdingList:function(e){var t=this,n={jsonrpc:"2.0",method:"Fund.FundHoldStockNoCategory",id:54321,params:{Fundid:e}};$.Func.ajax(n,function(n){var i=n.result,r=0,d=[];$.each(i.data,function(e,t){r+=t.percent,d.push({volume:t.volume,percent:t.percent,label:t.stockname})}),d.push({percent:1-r,label:"现金"});var o=a("holding-template",i);$("#holdingList").html(o),t.renderPage(e,r,d)})},operatingList:function(e){var t={jsonrpc:"2.0",method:"Fund.FundOperateRecord",id:54321,params:{Fundid:e,Count:2}};$.Func.ajax(t,function(t){var n=t.result;n.fundid=e;var i=a("operating-template",n);$("#operatingList").html(i)})},pay:function(){var e=r.fundid;location.href="../../pay/pay.html?productid="+e},renderPage:function(e,t,n){var i=this,r={jsonrpc:"2.0",method:"Fund.FundInfo",id:54321,params:{fundid:e}};$.Func.ajax(r,function(e){var r=e.result;r.data[0].per=t;var d=a("info-template",r.data[0]);$("#info").html(d),i.renderPie(n)})},renderPie:function(e){new i({selector:"#canvas_fan",data:e})},init:function(){$.Func.getUserInfo(),$.User.wxgzh||(location.href=$.CONFIG.INDEX),this.fundid=$.Func.getParam("fundid"),this.fundid&&(this.holdingList(this.fundid),this.operatingList(this.fundid),this.bindEvent())}};n.exports=r});