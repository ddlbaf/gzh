define("club/wallet",["libs/subscribe","libs/template"],function(e,t,n){var i=e("libs/subscribe"),s=e("libs/template");s.helper("numToPercent",function(e){return(100*e).toFixed(2)}),s.helper("shortDate",function(e){return e.substring(4,6)+"."+e.substring(6)});var a={bindEvent:function(){$("body").delegate(".js-tap",$.Func.TAP,function(e){var t=$(this).data("handler");a[t]&&a[t].call(this)})},subscribe:function(){var e=$(this).data("productid");return!!e&&void($.User.wxgzh?location.href="../../pay/pay.html?productid="+e:$.Func.showLayer("#popBindAccount"))},addStock:function(){var e={jsonrpc:"2.0",method:"WeiPan.WeiPanStocks",id:54321,params:{userid:"186656397319",stockid:"000002.SH",seq:4,token:"da97b4ccb9fc02b66534f6ff31efc60e938da8ae"}};$.Func.ajax(e,function(e){var t=e.result;t&&$(this).addClass("on")})},closeLayer:function(){$(this).parent().parent().removeClass("show")},formatDate:function(e){var t="";return e&&(t=e.substring(0,4)+"年"+e.substring(4,6)+"月"+e.substring(6)+"日"),t},getWeipan:function(){var e=this,t={jsonrpc:"2.0",method:"WeiPan.WeiPanStocks",id:54321,params:{}};$.Func.ajax(t,function(t){var n=t.result;if(n){var i=n.data.length||0,a=s("li-template",n);$("#date").html(e.formatDate(n.date.toString())),$("#recommend").html(n.data.length),$("#stockList").html(a),i||$("#subscribe").addClass("show-empty")}})},init:function(){var e=this;if($.Func.getUserInfo(),$.User.wxgzh){var t=$.User.userid,n="weipan";i.vipService(t,function(t){~$.inArray(n,t)?(e.getWeipan(),$("#subscribe").removeClass("hide")):$("#noSubscribe").removeClass("hide")})}else $("#noSubscribe").removeClass("hide");this.bindEvent()}};n.exports=a});